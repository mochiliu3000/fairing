apiVersion: tekton.dev/v1alpha1
kind: TaskRun
metadata:
  name: fairing-build-push
spec:
  taskRef:
    name: fairing-build-push
  inputs:
    params:
    - name: "context_sub_dir"
      value: "build1/context"
    - name: "dockerfile_sub_dir"
      value: "build1/context/Dockerfile"
  outputs:
    resources:
    - name: builtImage
      resourceRef:
        name: fairing-build-push-kaniko
  workspaces:
    - name: fairing-build
      persistentVolumeClaim:
        claimName: fairing-build-pvc
    - name: docker-registry-config
      configMap:
        name: docker-registry-config
        items:
          - key: config.json
            path: config.json

---

apiVersion: tekton.dev/v1alpha1
kind: TaskRun
metadata:
  name: fairing-job-deploy
spec:
  taskRef:
    name: fairing-job-deploy
  inputs:
    params:
    - name: "job_yaml_sub_dir"
    value: "build1/fairing-job.yaml"
    resources:
    - name: builtImage
      resourceRef:
        name: fairing-build-push-kaniko
    - name: remote_kubeconfig
      resourceRef:
        name: fairing-deploy-kube-config
  workspaces:
  - name: fairing-build
    persistentVolumeClaim:
      claimName: fairing-build-pvc